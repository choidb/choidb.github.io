---
title: '베이지안'
use_math: true
categories:
  - data
---


**목차**  
[1. 베이지안](#1-베이지안)  
 
---
* Contents
  1. 조건부 확률
  2. 베이지안 통계


>
* Keywards
  * 몬티홀

---

## 1. 베이지안
* 총 확률의 법칙(The Law of Total Probability)
  * A라는 특정 확률 변수에 대해 모든 가능한 이벤트의 총 확률은 1이다.
  * $P(A) = \sum_n P(A_n) = 1$
  * $A$와 $B$의 2가지 변수가 연관이 있는 경우, B가 일어난 상황에서의 A에 대한 확률 $P(A)$는 $P(A|B)$로 표현함. (연관이 없는 경우, $B$가 일어난 상황에서, $A$에 대한 확률 $P(A)$는 $P(A) * P(B)$이다.)
  * $P(A) = \sum_n P(A | B_n) P(B_n)$
>
* **조건부 확률(The Law of Conditional Probability)**
  * 어떤 사건이 일어나는 경우에 다른 사건이 일어날 확률
  * 사건 $B$가 일어나는 경우에 사건 $A$가 일어날 확률을 '사건 $B$에 대한 $A$의 조건부확률'이라 하고, $P(A \vert B)P(A∣B)$로 표기하며 '$P A$ given $B$' 또는 '$P A$ bar $B$'로 읽는다. $P(A|B)P(A∣B)$는 사건 $B$의 영향을 받아 변할 수 있으며, 일반적으로 $P(A | B)$와 $P(B | A)$는 같지 않다.
  * $P(A|B) = \frac{P(A \cap B)}{P(B)}$
>
* **베이지안 이론 (Bayes Theorem)**
  * 핵심공식 유도과정
    1. $P(A|B) = {P(A \cap B) \over P(B)}$
    2. $P(B|A) = {P(B \cap A) \over P(A)}$
    3. $P(A \cap B) = P(B \cap A),$
    4. $P(A|B) \cdot P(B) = P(B|A) \cdot P(A)$
    5. $P(A|B) = \frac{P(B|A)P(A)}{P(B)}$
  * $B$가 주어진 상황에서 $A$의 확률은 $A$가 주어진 상황에서의 $B$의 확률 곱하기 $A$의 확률, 나누기 $B$ 의 확률로 표현
  * $p(A|B)$ -> 사후 확률. (B라는 정보가 업데이트 된 이후의 사(이벤트)후 확률)
  * $p(A)$ -> 사전 확률. B라는 정보가 업데이트 되기 전의 사전확률
  * $p(B|A)$ -> data 
>
* 위키피디아 예시
  * 가정 : 약물을 실제 사용 하는 경우 결과가 양성일 확률은 99%

베이지안을 적용하는 예시는 매우 많지만, 그중 하나는 약에 대한 양성반응 테스트 입니다. 

일반적으로, 이 테스트에서 양성반응이 나온 경우 실제로 약물이 신체에 포함되어 있을 것이라고 생각하지만. 

만약 1%의 위양성 (False positive, 실제로 약물이 없지만 양성반응이 나타남)이 존재하는 경우에도 테스트의 의미는 매우 크게 바뀝니다. 

실제 분석을 위해, 전체 인구에서 0.5%, ($1/200$) 만이 실제로 약물이 신체에 포함되어 있다고 가정해보도록 하겠습니다.

양성반응 테스트의 결과가 양성으로 나왔을 경우 실제로 약물이 있을 확률은 어느정도가 될까요? 

단순히 생각하면, False positive를 제외한 99%라고 생각 할 수 있습니다만 우리는 이제 사전확률과 사후확률을 사용 할 수 있기 때문에 베이지안을 통해 검증해보도록 하겠습니다.

다음 계산 결과에서, $User$는 실제 약물이 발견 되는 사람, $+$는 양성반응입니다.


$P(User|+) = {P(+|User)P(User) \over P(+)}$<br/>
　　　　　　$= {P(+|User)P(User) \over P(+|User)P(User) + P(+|Non-user)P(Non-user)}$<br/>
　　　　　　$= {0.99 \times 0.005 \over 0.99 \times 0.005 + 0.01 \times 0.995}$<br/>
　　　　　　$\approx 33.2%$ <br/>
즉, 오직 33.2% 정도 만이 양성반응이 나왔다고 해도 실제로 약물을 포함 하는 경우입니다. 

이러한 이유로 인해 실제 상황에서는 여러번 반복해서 실험을 합니다. 

만약 2번을 반복 해서 모두 양성이 나오는 경우, 3번을 반복하는 경우... 에 따라서, 양성반응이 실제 약물로 부터 나온 결과일 확률은 매우 높아집니다.

이처럼 베이지안은 약물의 반응, 음주 측정, 임신 여부와 같이 많은 부분에서 사용되며, 이에 대하여 항상 false positive rate와 사전확률을 통해 정확한 확률을 계산 할 수 있어야 합니다. 


